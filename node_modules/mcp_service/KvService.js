var dao = require('mcp_dao');
var dc = dao.dc;

var KvService = function(){};

KvService.prototype.getPrintSeqId = function(cb)
{
    var kvTable = dc.mg.get("mcp_id");
    kvTable.findAndModify({_id:"print_seq"}, {}, {$inc:{value:1}}, {}, function(err, data){
        cb(err, data);
    });
};

KvService.prototype.getNotifyQueenId = function(cb)
{
    var kvTable = dc.mg.get("mcp_id");
    var id = "notify_seq";
    kvTable.findAndModify({_id:id}, {}, {$inc:{value:1}}, {upsert:true}, function(err, data){
        cb(err, data);
    });
};

module.exports = new KvService();